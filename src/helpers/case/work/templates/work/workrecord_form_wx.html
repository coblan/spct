{% extends "wx/base.html" %}
{% load static %}
{% load jsonify %}


{% block page_content %}
<script src='{% static "js/ex_inputs.pack.js?t=" %}{{ stamp.ex_inputs_pack_js}}'></script>

{% include 'work/com_workindex.html' %}

<!--{% include 'organize/com_department_wx.html' %}-->

<script type="text/javascript">


    with_menu=false
    ex.each(heads,function(head){
        if(head.name=='work'){
            head.type='btn-dir'
        }
    })


form_logic={
    el:'#there',
    data:{
//                menu:menu,
        crt_view:'main',
        page_label:page_label,
        is_shrink:true,

    },
    mixins:[field_fun],

    computed:{

    },
//            mounted:function(){
//                var self=this
//                setTimeout(function(){
//                    self.$refs.scroller.refresh()
//                },500)
//            },
    methods:{
        router:function(state){
            if(state.crt_view){
                this.crt_view=state.crt_view
            }
        },
        goto:function(url){
            location=url
        },



        shrinked:function(heads){
            if(this.is_shrink){
                return ex.sort_by_names(this.kw.heads,['work','finish_time','count','short'])
            }else{
                return ex.sort_by_names(this.kw.heads,['work','finish_time','count','short','status'],true)
            }

        },
        expand:function(){
            this.is_shrink=false
//                    var self=this
//                    setTimeout(function(){
//                        self.$refs.scroller.refresh()
//                    },500)
        },


    }
}


    $(function(){
        form =new Vue(form_logic)
    })
</script>

{% block extra_head %}
{% endblock %}

<div id="there" v-cloak style="overflow: auto">
    <div v-show="crt_view=='main'">

        <!--<scroll-wraper class="flex-grow"  ref="scroller" style="min-height: 100vh;">-->

            <!--<div class="weui-cells__title" v-text="page_label">编辑内容</div>-->

            <div class="form-pad">
                <field v-for="head in shrinked(kw.heads)" :name="head.name" :kw="kw"></field>
                <div v-if="is_shrink" @click="expand()" style="position: absolute;right:1em;padding: 0.3em;color: #3c8aff;">更多<i class="fa fa-angle-down" aria-hidden="true"></i></div>
            </div>


            <div v-btn-group>
                <a state="success" @click="submit()">确定</a>
            </div>
        <!--</scroll-wraper>-->
        <!--<div style="text-align: center;padding-top: 3em;">-->

        <!--<a type="button" class="btn btn-success btn-sm" href="javascript:"  @click="submit()" style="width: 16em;">确定</a>-->

        <!--</div>-->

    </div>
    <!--<div v-show="crt_view=='dir'">-->
        <!--<com-catalog class="mobile" ref="catalog" :url="workindex_url" :root="{pk:null,name:'root'}"-->
                     <!--@itemclick="itclick($event)" :editable="false"></com-catalog>-->
        <!-- -->
    <!--</div>-->

    <!--<iframe :src="out_src" frameborder="0" style="width: 100vw;height: 100vh;"></iframe>-->
</div>

<style type="text/css">

</style>


<!--<template id="btn-dir">-->
    <!--<div >-->
        <!--<span v-if="kw.readonly" v-text="show_name"></span>-->
        <!--<button type="button" class="btn btn-default btn-sm" v-else @click="open()" v-text="show_name" style="color: #0099CC;padding: 0.3em 2em;" :disabled="is_tmp"></button>-->
    <!--</div>-->
<!--</template>-->
<!--<script type="application/javascript">-->
    <!--Vue.component('btn-dir',{-->
        <!--template:'#btn-dir',-->
        <!--props:['row','name','kw'],-->
        <!--data:function(){-->
            <!--return {-->
                <!--is_tmp:false-->
            <!--}-->
        <!--},-->
        <!--watch:{-->
        <!--},-->


        <!--computed:{-->
            <!--show_name:function(){-->
                <!--var pk =this.row[this.name]-->
                <!--var option = ex.findone(this.kw.options,{value:pk})-->
                <!--if(option){-->
                    <!--return option.label-->
                <!--}else{-->
                    <!--return '点击选择'-->
                <!--}-->
            <!--}-->
        <!--},-->

<!--//        computed:{-->
<!--//            show_name:function(){-->
<!--//                var pk =this.row[this.name]-->
<!--//                var option = ex.findone(this.kw.options,{value:pk})-->
<!--//                if(option){-->
<!--//                    return option.label-->
<!--//                }else{-->
<!--//                    return '点击选择'-->
<!--//                }-->
<!--//            }-->
<!--//        },-->
        <!--methods:{-->
            <!--open:function(){-->
                <!--var self=this-->
                <!--depart_win.get_department(null,function(depart){-->
                    <!--Vue.set(self.row,self.name,depart.pk)-->
<!--//                    self.row[self.name]=depart.pk-->
                <!--})-->


            <!--}-->
        <!--}-->
    <!--})-->

<!--</script>-->


{% endblock %}